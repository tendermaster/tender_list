<%#
  app/views/layouts/_funding_infobar.html.erb

  This infobar is designed to be:
  - Initially hidden, revealed by jQuery.
  - Dismissible for the current browser session using sessionStorage.
%>

<%# You can set this URL in a controller or helper for better practice %>
<% google_form_url = "https://docs.google.com/forms/d/e/1FAIpQLScBTGDWwnedq98NEdcfv5GBcfkeDFxx0oYggrt3m2gaAR_hAw/viewform?usp=dialog" %>

<div id="funding-infobar" class="hidden bg-orange-100 border-b border-orange-200 text-orange-900 mb-8 rounded-xl" role="alert">
  <div class="mx-auto px-4 py-3">
    <div class="flex flex-wrap items-center justify-between gap-x-6 gap-y-2">

      <!-- Icon and Text Content -->
      <div class="flex items-center gap-x-3">
        <div class="flex-shrink-0">
          <!-- Checkmark Icon (Heroicons) -->
          <svg class="h-6 w-6 text-orange-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
          </svg>
        </div>
        <p class="text-sm leading-6">
          <strong class="font-semibold">Check your funding eligibility in 2 minutes. <br />Answer a few questions and our team will contact you with your best options.</strong>
        </p>
      </div>

      <!-- Action Buttons -->
      <div class="flex flex-shrink-0 items-center gap-x-4">
        <!-- Main CTA to Google Form -->
        <a href="<%= google_form_url %>" target="_blank" rel="noopener noreferrer" class="rounded-md bg-orange-600 px-3.5 py-1.5 text-sm font-semibold text-white shadow-sm hover:bg-orange-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-orange-600 transition-colors">
          Start Quick Check â†’
        </a>

        <!-- Close Button -->
        <button id="close-infobar-btn" type="button" class="-m-1.5 p-1.5" aria-label="Dismiss">
          <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
            <path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"/>
          </svg>
        </button>
      </div>

    </div>
  </div>
</div>

<script>
    $(function () {
        const infobar = $('#funding-infobar');
        const closeButton = $('#close-infobar-btn');

        // if opened
        if (sessionStorage.getItem('infobarClosed') !== 'true') {
            // If opened, show it with a smooth slide-down animation
            infobar.slideDown('fast');
        }

        closeButton.on('click', function () {
            // When clicked, slide the bar up
            infobar.slideUp('fast', function () {
                // After the animation completes, set the session storage item
                // This prevents the bar from showing up on the next page load in this session
                sessionStorage.setItem('infobarClosed', 'true');
            });
        });
    });
</script>
