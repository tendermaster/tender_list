<% title "#{@tender_data.title&.titleize}" %>
<% description "sigmatenders.com is a tender portal specifically designed for independent entrepreneurs/ Business houses/ industries and  non-government organizations (NGOs) to get Realtime notifications of potential opportunities for their enterprise" %>
<% keywords "sigma tenders, ngo service tenders, #{@tender_data.title.capitalize}, #{@tender_data.organisation} organization"&.titleize %>
<% set_meta_tags og: {
  title: @tender_data.title&.titleize,
  type: "website",
  url: "#{Rails.application.config.site_url}/tender/#{@tender_data.slug_uuid}",
} %>
<% set_meta_tags image_src: url_for('/apple-touch-icon.png') %>

<%= render 'layouts/navbar' %>

<div class="text-gray-800 lg:pt-2 xl:px-36">
  <!--header-->

  <!-- content -->
  <div class="mx-8 my-12">

    <div class="">

      <div class="mt-6">
        <%= render partial: 'tender_search', locals: {
          query: ''
        } %>
      </div>

      <div class="flex items-center">
        <h3 class="my-8 text-xl font-semibold">Tender Details</h3>
        <div class="ml-4">
          <button id="bookmark-btn" data-page-id="<%= @tender_data.slug_uuid %>" class="flex items-center p-2 rounded-lg border-2 border-orange-500 font-semibold shadow-sm <%= tender_bookmarked?(current_user&.id, @tender_data.id) ? 'bg-orange-600 text-white' : '' %>">
            <p class="mr-1">Save</p>
            <svg width="20px" height="20px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M21 16.0909V11.0975C21 6.80891 21 4.6646 19.682 3.3323C18.364 2 16.2426 2 12 2C7.75736 2 5.63604 2 4.31802 3.3323C3 4.6646 3 6.80891 3 11.0975V16.0909C3 19.1875 3 20.7358 3.73411 21.4123C4.08421 21.735 4.52615 21.9377 4.99692 21.9915C5.98402 22.1045 7.13673 21.0849 9.44216 19.0458C10.4612 18.1445 10.9708 17.6938 11.5603 17.5751C11.8506 17.5166 12.1494 17.5166 12.4397 17.5751C13.0292 17.6938 13.5388 18.1445 14.5578 19.0458C16.8633 21.0849 18.016 22.1045 19.0031 21.9915C19.4739 21.9377 19.9158 21.735 20.2659 21.4123C21 20.7358 21 19.1875 21 16.0909Z" stroke="#1C274D" stroke-width="1.5"/>
              <path opacity="0.5" d="M15 6H9" stroke="#1C274D" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
          </button>
        </div>
      </div>

      <div class="lg:grid grid-cols-12 gap-x-8">
        <div class="relative col-span-8 overflow-x-auto">
          <% if !@tender_data.short_blog.nil? %>
            <div class="px-4 mb-8 prose whitespace-pre-line text-center">
              <h2 class="text-lg">About Tender</h2>
              <%= @tender_data.short_blog.titleize %>
            </div>
          <% end %>
          <table
            class="w-full overflow-hidden text-left text-sm text-gray-500 dark:text-gray-400 sm:rounded-lg"
          >
            <thead
              class="bg-gray-50 text-xs uppercase text-gray-700 dark:bg-gray-700 dark:text-gray-400"
            >
            <tr>
              <th scope="col" class="py-3 px-6">Particulars</th>
              <th scope="col" class="py-3 px-6">Details</th>
            </tr>
            </thead>
            <tbody class="grid sm:table-row-group">
            <tr
              class="border-b bg-white dark:border-gray-700 dark:bg-gray-800"
            >
              <th
                scope="row"
                class="whitespace-nowrap py-4 px-6 font-medium text-gray-900 dark:text-white"
              >
                Title
              </th>
              <td class="py-4 px-6 select-none flex">
                <% if User.can_fully_view_tender(current_user, @tender_data.submission_close_date) || !is_tender_id?(@tender_data.title) %>
                  <% if User.active_plan(current_user) === 'PAID' %>
                    <div class="select-text">
                      <%= @tender_data.title&.titleize %>
                    </div>
                  <% else %>
                    <div><%= @tender_data.title&.titleize %></div>
                  <% end %>
                <% else %>
                  <p class="blur-md select-none">AAAAAAAAAA</p>
                  <%= render 'plan_to_view_tender' %>
                <% end %>
              </td>
            </tr>
            <tr
              class="border-b bg-white dark:border-gray-700 dark:bg-gray-800"
            >
              <th
                scope="row"
                class="whitespace-nowrap py-4 px-6 font-medium text-gray-900 dark:text-white"
              >
                Description
              </th>
              <td class="py-4 px-6 select-none">
                <% if User.active_plan(current_user) == 'PAID' %>
                  <div class="select-text">
                    <%= @tender_data.description&.titleize %>
                  </div>
                <% else %>
                  <div>
                    <%= @tender_data.description&.titleize %>
                  </div>
                <% end %>
              </td>
            </tr>
            <tr
              class="border-b bg-white dark:border-gray-700 dark:bg-gray-800"
            >
              <th
                scope="row"
                class="whitespace-nowrap py-4 px-6 font-medium text-gray-900 dark:text-white"
              >
                Organisation
              </th>
              <td class="py-4 px-6"><%= @tender_data.organisation %></td>
            </tr>
            <tr
              class="border-b bg-white dark:border-gray-700 dark:bg-gray-800"
            >
              <th
                scope="row"
                class="whitespace-nowrap py-4 px-6 font-medium text-gray-900 dark:text-white"
              >
                Tender Id
              </th>
              <td class="py-4 px-6 flex">
                <% if User.can_fully_view_tender(current_user, @tender_data.submission_close_date) %>
                  <%= @tender_data.tender_id %>
                <% else %>
                  <p class="blur-md select-none">AAAAAAAAAA</p>
                  <%= render 'plan_to_view_tender' %>
                <% end %>
              </td>
            </tr>
            <tr
              class="border-b bg-white dark:border-gray-700 dark:bg-gray-800"
            >
              <th
                scope="row"
                class="whitespace-nowrap py-4 px-6 font-medium text-gray-900 dark:text-white"
              >
                Reference <br> Number
              </th>
              <td class="py-4 px-6 flex">
                <% if User.can_fully_view_tender(current_user, @tender_data.submission_close_date) %>
                  <%= @tender_json['TenderReferenceNumber'] || @tender_data.tender_reference_number %>
                <% else %>
                  <p class="blur-md select-none">AAAAAAAAAA</p>
                  <%= render 'plan_to_view_tender' %>
                <% end %>
              </td>
            </tr>
            <tr
              class="border-b bg-white dark:border-gray-700 dark:bg-gray-800"
            >
              <th
                scope="row"
                class="whitespace-nowrap py-4 px-6 font-medium text-gray-900 dark:text-white"
              >
                Tender Fee
              </th>
              <td class="py-4 px-6"><%= currency_format(@tender_data.tender_fee) %></td>
            </tr>
            <tr
              class="border-b bg-white dark:border-gray-700 dark:bg-gray-800"
            >
              <th
                scope="row"
                class="whitespace-nowrap py-4 px-6 font-medium text-gray-900 dark:text-white"
              >
                EMD
              </th>
              <td class="py-4 px-6"><%= currency_format(@tender_data.emd) %></td>
            </tr>
            <tr
              class="border-b bg-white dark:border-gray-700 dark:bg-gray-800"
            >
              <th
                scope="row"
                class="whitespace-nowrap py-4 px-6 font-medium text-gray-900 dark:text-white"
              >
                Tender Value
              </th>
              <td class="py-4 px-6"><%= currency_format(@tender_data.tender_value) %></td>
            </tr>
            <!--              <tr-->
            <!--                class="border-b bg-white dark:border-gray-700 dark:bg-gray-800"-->
            <!--              >-->
            <!--                <th-->
            <!--                  scope="row"-->
            <!--                  class="whitespace-nowrap py-4 px-6 font-medium text-gray-900 dark:text-white"-->
            <!--                >-->
            <!--                  Time Period-->
            <!--                </th>-->
            <!--                <td class="py-4 px-6">730d</td>-->
            <!--              </tr>-->
            <tr
              class="border-b bg-white dark:border-gray-700 dark:bg-gray-800"
            >
              <th
                scope="row"
                class="whitespace-nowrap py-4 px-6 font-medium text-gray-900 dark:text-white"
              >
                Place
              </th>
              <td class="py-4 px-6"><%= @tender_data.state %></td>
            </tr>
            <tr
              class="border-b bg-white dark:border-gray-700 dark:bg-gray-800"
            >
              <th
                scope="row"
                class="whitespace-nowrap py-4 px-6 font-medium text-gray-900 dark:text-white"
              >
                Link
              </th>
              <td class="py-4 px-6 flex">
                <% if User.can_fully_view_tender(current_user, @tender_data.submission_close_date) %>
                  <a class="underline underline-offset-2 hover:text-blue-600 force-word-break" target="_blank" rel="nofollow" href="<%= @tender_data.page_link %>"><%= @tender_data.page_link %></a>
                <% else %>
                  <p class="blur-md select-none">AAAAAAAAAA</p>
                  <%= render 'plan_to_view_tender' %>
                <% end %>
              </td>
            </tr>
            <tr
              class="border-b bg-white dark:border-gray-700 dark:bg-gray-800"
            >
              <th
                scope="row"
                class="whitespace-nowrap py-4 px-6 font-medium text-gray-900 dark:text-white"
              >
                Start Date
              </th>
              <td class="py-4 px-6"><%= @tender_data.submission_open_date&.in_time_zone("Asia/Kolkata").to_formatted_s(:long) %></td>
            </tr>
            <tr
              class="border-b bg-white dark:border-gray-700 dark:bg-gray-800"
            >
              <th
                scope="row"
                class="whitespace-nowrap py-4 px-6 font-medium text-gray-900 dark:text-white"
              >
                End Date
              </th>
              <td class="py-4 px-6 <%= time_left(@tender_data.submission_close_date) >= 0 ? "bg-green-200" : 'bg-red-200' %>">
                <div class="md:flex md:items-center">
                  <p><%= @tender_data.submission_close_date.strftime("%d/%m/%Y") %>
                    ( <%= time_left_text(@tender_data.submission_close_date) %> )
                  </p>
                  <a class="btn-sm inline-block mt-2 md:mt-0 md:ml-10" href="<%= root_path %>">Search Similar
                    tenders?</a>
                </div>
              </td>
            </tr>
            <tr
              class="border-b bg-white dark:border-gray-700 dark:bg-gray-800"
            >
              <th
                scope="row"
                class="whitespace-nowrap py-4 px-6 font-medium text-gray-900 dark:text-white"
              >
                Join for More <br> Relevant Opportunities
              </th>
              <td class="py-4 px-6">
                <div class="md:flex md:items-center mr-8">
                  <a class="px-3 py-2 bg-green-500 rounded-full text-white" href="https://whatsapp.com/channel/0029Vab3ADv7YSd4FZmQpj02" target="_blank">Whatsapp
                    Channel</a>
                </div>

                <div class="md:flex md:items-center mt-4">
                  <a class="px-3 py-2 bg-green-500 rounded-full text-white" href="https://wa.me/918882301033" target="_blank">Whatsapp
                    Support</a>
                </div>
              </td>
            </tr>
            </tbody>
          </table>

          <div>
            <!--            tender results-->
            <% if @bid_result.present? %>
              <%= render 'tenders/partials/tender_results' %>
            <% end %>
          </div>

          <div class="similar-tenders">
            <div class="text-lg font-bold my-8">Similar Tenders</div>
            <div class="flex justify-center">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <% TendersController.similar_tenders(is_tender_id?(@tender_data.title) ? @tender_data.description : @tender_data.title, @tender_data.id).each do |tender| %>
                  <div class="max-w-sm p-6 bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700">
                    <a href="<%= tender_show_path(tender.slug_uuid) %>">
                      <%# no perm needed to only view title %>
                      <% if User.can_fully_view_tender(current_user, tender.submission_close_date) || !is_tender_id?(tender.title) %>
                        <h5 class="mb-2 text-2xl font-bold tracking-tight text-gray-900 dark:text-white"><%= tender.title&.capitalize %></h5>
                      <% else %>
                        <div class="flex">
                          <h5 class="mb-2 text-2xl font-bold tracking-tight text-gray-900 dark:text-white blur-md select-none">AAAAAAAAAA</h5>
                          <%= render 'plan_to_view_tender' %>
                        </div>
                      <% end %>
                    </a>
                    <p class="mb-3 font-normal text-gray-700 dark:text-gray-400">
                      <%= tender.description&.capitalize %>
                    </p>
                    <a href="<%= tender_show_path(tender.slug_uuid) %>" class="inline-flex items-center px-3 py-2 text-sm font-medium text-center text-white bg-orange-700 rounded-lg hover:bg-orange-800 focus:ring-4 focus:outline-none focus:ring-orange-300 dark:bg-orange-600 dark:hover:bg-orange-700 dark:focus:ring-orange-800">
                      Read more
                      <svg class="rtl:rotate-180 w-3.5 h-3.5 ms-2" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 10">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 5h12m0 0L9 1m4 4L9 9"/>
                      </svg>
                    </a>
                  </div>

                <% end %>
              </div>
            </div>
          </div>

          <!--Attachments-->
          <div class="mt-6">
            <a href="<%= how_to_file_tender_path %>" class="link block">How to file this tender?</a>
            <a href="<%= get_callback_path %>" class="link block mt-4">Request filing assistance</a>
          </div>

        </div>

        <div class="col-span-4 mt-10 lg:mt-0">
          <%= render "get_relevant_tenders_form" %>
        </div>
      </div>
    </div>


  </div>
</div>

<%= render 'layouts/footer' %>

<!--<div class="bg-sky-900 text-white">s</div>-->
